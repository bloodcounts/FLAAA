<?xml version="1.0" encoding="UTF-8"?>
<!--
  Test Case: S-TC018
  Description: task_expires 1 second before current-dateTime should deny (task-authorization)
  Expected Decision: Deny
  Policy Rule: deny-wrong-task-or-expired
  Threat Category: Temporal policy violation
-->
<Request xmlns="urn:oasis:names:tc:xacml:3.0:core:schema:wd-17">

  <!-- Action -->
  <Attributes Category="urn:oasis:names:tc:xacml:3.0:attribute-category:action">
    <Attribute AttributeId="action" IncludeInResult="true">
      <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">task-authorization</AttributeValue>
    </Attribute>
  </Attributes>


  <!-- Resource -->
  <Attributes Category="urn:oasis:names:tc:xacml:1.0:attribute-category:resource">
    <Attribute AttributeId="task_id" IncludeInResult="true">
      <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">medical</AttributeValue>
    </Attribute>
    <Attribute AttributeId="task_expires" IncludeInResult="true">
      <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#dateTime">2025-06-15T11:59:59Z</AttributeValue>
    </Attribute>
  </Attributes>



  <!-- Environment -->
  <Attributes Category="urn:oasis:names:tc:xacml:3.0:attribute-category:environment">
    <Attribute AttributeId="current-dateTime" IncludeInResult="true">
      <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#dateTime">2025-06-15T12:00:00Z</AttributeValue>
    </Attribute>
  </Attributes>

</Request>
